better rehydrating, allow a mapper fn
